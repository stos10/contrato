<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gerenciamento de Contratos</title>
    <!-- Carrega a biblioteca externa para manipulação de planilhas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Carrega a folha de estilos externa -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>Sistema de Gerenciamento de Contratos</h1>
        </div>
    </header>
    
    <nav class="navbar">
        <div class="container">
            <a href="#detalhes">Detalhes</a>
            <a href="#servicos">Serviços</a>
            <a href="#cidades">Cidades</a>
            <a href="#quantidades">Quantidades</a>
            <a href="#configuracoes">Configurações</a>
            <a href="#calculos">Cálculos e Exportação</a>
        </div>
    </nav>
    
    <main class="container">
        <!-- Seção de Detalhes do Contrato e Cliente -->
        <section id="detalhes" class="section">
            <div class="status">
                <h3>Status da Etapa</h3>
                <p>Preencha os dados do contrato e cliente para continuar.</p>
            </div>
            <h2>Detalhes do Contratado</h2>
            <div class="grid-form">
                <div class="form-group"><label>Nome do Contratado:</label><input type="text" id="nome-contratado"></div>
                <div class="form-group"><label>CNPJ/CPF:</label><input type="text" id="cnpj-contratado"></div>
                <div class="form-group"><label>Endereço:</label><input type="text" id="endereco-contratado"></div>
                <div class="form-group"><label>Município:</label><input type="text" id="municipio-contratado"></div>
                <div class="form-group"><label>Contato:</label><input type="text" id="contato-contratado"></div>
                <div class="form-group"><label>Telefone:</label><input type="text" id="telefone-contratado"></div>
                <div class="form-group"><label>E-mail:</label><input type="email" id="email-contratado"></div>
                <div class="form-group"><label>N.º CONTRATO FÍSICO:</label><input type="text" id="contrato-fisico"></div>
                <div class="form-group"><label>N.º CONTRATO SAP:</label><input type="text" id="contrato-sap-global"></div>
                <div class="form-group"><label>CÓD. FORNECEDOR:</label><input type="text" id="cod-fornecedor"></div>
                <div class="form-group"><label>VALOR CONTRATO:</label><input type="text" id="valor-contrato"></div>
                <div class="form-group"><label>VALOR ADITIVO:</label><input type="text" id="valor-aditivo"></div>
                <div class="form-group"><label>PRAZO CONTRATO:</label><input type="text" id="prazo-contrato"></div>
                <div class="form-group"><label>EXEC. INÍCIO:</label><input type="date" id="exec-inicio"></div>
                <div class="form-group"><label>EXEC. TÉRMINO:</label><input type="date" id="exec-termino"></div>
                <div class="form-group"><label>VIGÊNCIA:</label><input type="text" id="vigencia"></div>
                <div class="form-group"><label>VIG. TÉRMINO:</label><input type="date" id="vig-termino"></div>
                <div class="form-group"><label>VLR UTILIZADO:</label><input type="text" id="vlr-utilizado"></div>
            </div>
            <div class="summary">
                <p id="total-contratos">R$ 0,00 - Valor Total do Contrato</p>
                <p id="saldo-disponivel">R$ 0,00 - Saldo Disponível</p>
            </div>
            <h2>Detalhes do Cliente</h2>
            <div class="grid-form">
                <div class="form-group"><label>Nome do Cliente:</label><input type="text" id="nome-cliente"></div>
                <div class="form-group"><label>CNPJ/CPF do Cliente:</label><input type="text" id="cnpj-cliente"></div>
                <div class="form-group"><label>Endereço do Cliente:</label><input type="text" id="endereco-cliente"></div>
                <div class="form-group"><label>Município do Cliente:</label><input type="text" id="municipio-cliente"></div>
                <div class="form-group"><label>Contato do Cliente:</label><input type="text" id="contato-cliente"></div>
                <div class="form-group"><label>Telefone do Cliente:</label><input type="text" id="telefone-cliente"></div>
                <div class="form-group"><label>E-mail do Cliente:</label><input type="email" id="email-cliente"></div>
                <div class="form-group"><label>OBJ. CONTRATO:</label><input type="text" id="obj-contrato"></div>
            </div>
            <button class="button success" id="salvar-dados">Salvar Dados do Contrato</button>
        </section>

        <!-- Seção de Serviços e Preços -->
        <section id="servicos" class="section">
            <div class="status"><h3>Status da Etapa</h3><p>Configure os serviços e preços unitários.</p></div>
            <h2>Serviços e Preços Unitários</h2>
            <div class="form-group"><label>Serviços Disponíveis (separados por vírgula ):</label><textarea id="servicos-disponiveis" rows="4"></textarea></div>
            <h3>Região Metropolitana</h3>
            <div class="grid-form">
                <div class="form-group"><label>Preços OPEX (separados por vírgula):</label><input type="text" id="opex-metro"></div>
                <div class="form-group"><label>Preços CAPEX (separados por vírgula):</label><input type="text" id="capex-metro"></div>
            </div>
            <h3>Região Interior</h3>
            <div class="grid-form">
                <div class="form-group"><label>Preços OPEX (separados por vírgula):</label><input type="text" id="opex-interior"></div>
                <div class="form-group"><label>Preços CAPEX (separados por vírgula):</label><input type="text" id="capex-interior"></div>
            </div>
            <button class="button success" id="salvar-precos">Salvar Preços</button>
        </section>

        <!-- Seção de Cidades -->
        <section id="cidades" class="section">
            <div class="status"><h3>Status da Etapa</h3><p>Cadastre as cidades onde os serviços serão executados.</p></div>
            <h2>Cadastro de Cidades</h2>
            <h3>Adicionar Nova Cidade</h3>
            <div class="grid-form">
                <div class="form-group"><label>Nome da Cidade:</label><input type="text" id="nome-cidade"></div>
                <div class="form-group"><label>Regional:</label><select id="regional-cidade"><option value="">Selecione...</option><option>Metropolitana</option><option>Interior</option></select></div>
                <div class="form-group"><label>Centro:</label><input type="text" id="centro-cidade"></div>
            </div>
            <button class="button" id="add-cidade">Adicionar Cidade</button>
            <h3>Importação em Lote</h3>
            <div class="form-group"><label>Importar Cidades (formato: Nome, Regional, Centro - uma por linha):</label><textarea id="import-cidades" rows="4" placeholder="Exemplo: São Paulo, Metropolitana, Centro 1"></textarea></div>
            <button class="button" id="import-btn">Importar Cidades</button>
            <h3>Cidades Cadastradas</h3>
            <div class="table-wrapper"><table id="cidades-table"><thead><tr><th>Nome</th><th>Regional</th><th>Centro</th><th>Ações</th></tr></thead><tbody></tbody></table></div>
        </section>

        <!-- Seção de Quantidades -->
        <section id="quantidades" class="section">
            <div class="status"><h3>Status da Etapa</h3><p>Defina as quantidades de cada serviço por cidade.</p></div>
            <h2>Quantidades por Cidade</h2>
            <div id="quantidades-form" class="table-wrapper"><p>Cadastre cidades para definir quantidades.</p></div>
        </section>

        <!-- Seção de Configurações Adicionais -->
        <section id="configuracoes" class="section">
            <div class="status"><h3>Status da Etapa</h3><p>Insira os dados específicos para cada cidade.</p></div>
            <h2>Configurações por Cidade</h2>
            <div id="configuracoes-form"><p>Cadastre cidades para definir as configurações.</p></div>
        </section>

        <!-- Seção de Cálculos e Exportação -->
        <section id="calculos" class="section">
            <div class="status"><h3>Status da Etapa</h3><p>Visualize os cálculos finais e exporte os dados.</p></div>
            <h2>Cálculos e Exportação</h2>
            <button class="button success" id="calcular-btn">Calcular Todos os Valores</button>
            <div id="resultados"><p>Clique em "Calcular" para visualizar os resultados.</p></div>
            <div class="export-section">
                <h3>Exportação de Dados</h3>
                <div class="export-buttons">
                    <button class="button success" id="export-excel">Exportar para Excel</button>
                    <button class="button" id="export-json">Exportar para JSON</button>
                </div>
                <div id="export-status" class="alert-container"></div>
            </div>
        </section>
    </main>
    
    <!-- Carrega o script principal da aplicação no final do body -->
    <script src="script.js"></script>
</body>
</html>
